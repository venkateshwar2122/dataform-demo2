config {
  type: "table",
  schema: "analytics2"
}

select
  a.campaign_date as date,
  a.source,
  sum(a.spend) as total_spend,
  r.total_revenue,
  (r.total_revenue - sum(a.spend)) as roi
from ${ref("ads_cleaned")} a
join ${ref("daily_revenue")} r
  on a.campaign_date = r.order_date
group by a.campaign_date, a.source, r.total_revenue
